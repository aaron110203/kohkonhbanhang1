<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin Panel - KohKong</title>
  <link rel="stylesheet" href="dashboard.css">
  <link rel="stylesheet" href="mobile-responsive.css">
  <style>
    .admin-header {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      padding: 20px;
      color: white;
      text-align: center;
    }

    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      margin: 20px 0;
    }

    .stat-card {
      background: white;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      text-align: center;
    }

    .stat-number {
      font-size: 2.5rem;
      font-weight: bold;
      color: #667eea;
    }

    .stat-label {
      color: #666;
      margin-top: 10px;
    }

    .agents-table {
      background: white;
      border-radius: 10px;
      overflow: hidden;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }

    .agents-table table {
      width: 100%;
      border-collapse: collapse;
    }

    .agents-table th {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 15px;
      text-align: left;
    }

    .agents-table td {
      padding: 15px;
      border-bottom: 1px solid #eee;
    }

    .agents-table tr:hover {
      background: #f5f5f5;
    }

    .badge {
      padding: 5px 15px;
      border-radius: 20px;
      font-size: 0.85rem;
      font-weight: bold;
    }

    .badge-free {
      background: #e3f2fd;
      color: #1976d2;
    }

    .badge-vip {
      background: linear-gradient(135deg, #ffd700 0%, #ffed4e 100%);
      color: #b8860b;
    }

    .btn-upgrade {
      background: linear-gradient(135deg, #ffd700 0%, #ffed4e 100%);
      color: #b8860b;
      border: none;
      padding: 8px 20px;
      border-radius: 5px;
      cursor: pointer;
      font-weight: bold;
    }

    .btn-upgrade:hover {
      transform: scale(1.05);
    }

    .btn-downgrade {
      background: #e0e0e0;
      color: #666;
      border: none;
      padding: 8px 20px;
      border-radius: 5px;
      cursor: pointer;
    }

    .btn-delete {
      background: #f44336;
      color: white;
      border: none;
      padding: 8px 20px;
      border-radius: 5px;
      cursor: pointer;
      margin-left: 10px;
    }

    .quota-bar {
      width: 100%;
      height: 8px;
      background: #eee;
      border-radius: 10px;
      overflow: hidden;
      margin-top: 5px;
    }

    .quota-fill {
      height: 100%;
      background: linear-gradient(90deg, #4caf50 0%, #8bc34a 100%);
      transition: width 0.3s;
    }

    .quota-text {
      font-size: 0.85rem;
      color: #666;
      margin-top: 5px;
    }

    /* Mobile Responsive Styles */
    @media (max-width: 1024px) {
      .stats-grid {
        grid-template-columns: repeat(2, 1fr);
      }
    }

    @media (max-width: 768px) {
      .admin-header h1 {
        font-size: 1.5rem;
      }

      .stats-grid {
        grid-template-columns: 1fr;
      }

      .stat-card {
        padding: 15px;
      }

      .agents-table {
        overflow-x: auto;
        -webkit-overflow-scrolling: touch;
      }

      table {
        min-width: 800px;
        font-size: 0.85rem;
      }

      th, td {
        padding: 8px;
        white-space: nowrap;
      }

      .btn-upgrade, .btn-downgrade, .btn-delete {
        padding: 6px 12px;
        font-size: 0.8rem;
        margin: 2px;
      }
    }

    @media (max-width: 576px) {
      .admin-header {
        padding: 15px;
      }

      .admin-header h1 {
        font-size: 1.2rem;
      }

      .stat-card h3 {
        font-size: 0.9rem;
      }

      .stat-card p {
        font-size: 1.5rem;
      }

      table {
        font-size: 0.75rem;
        min-width: 1000px;
      }

      th, td {
        padding: 6px;
      }

      .btn-logout {
        width: 100%;
        margin: 10px 0;
      }

      /* Scroll hint for tables */
      .agents-table::after {
        content: 'â† Vuá»‘t ngang Ä‘á»ƒ xem thÃªm â†’';
        display: block;
        text-align: center;
        color: #999;
        font-size: 0.8rem;
        padding: 10px;
        background: #f5f5f5;
        border-radius: 0 0 10px 10px;
      }
    }

    /* Touch-friendly buttons on mobile */
    @media (hover: none) {
      .btn-upgrade, .btn-downgrade, .btn-delete {
        min-height: 44px;
        min-width: 44px;
      }
    }

    /* Landscape mode optimization */
    @media (max-width: 896px) and (orientation: landscape) {
      .stats-grid {
        grid-template-columns: repeat(3, 1fr);
      }
    }
  </style>
</head>
<body>
  <script>
    // Check admin authentication
    const adminUser = localStorage.getItem('adminUser') || sessionStorage.getItem('adminUser');
    if (!adminUser) {
      alert('â›” Chá»‰ Admin má»›i Ä‘Æ°á»£c truy cáº­p!');
      window.location.href = 'admin-login.html';
    }
  </script>

  <!-- Header -->
  <div class="admin-header">
    <h1>ğŸ›¡ï¸ Admin Panel - KohKong BÃ¡n HÃ ng</h1>
    <p>Quáº£n lÃ½ Ä‘áº¡i lÃ½ vÃ  sáº£n pháº©m</p>
  </div>

  <div class="container" style="max-width: 1400px; margin: 20px auto; padding: 20px;">
    <!-- Stats -->
    <div class="stats-grid">
      <div class="stat-card">
        <div class="stat-number" id="totalAgents">0</div>
        <div class="stat-label">Tá»•ng Äáº¡i LÃ½</div>
      </div>
      <div class="stat-card">
        <div class="stat-number" id="totalVIP">0</div>
        <div class="stat-label">Äáº¡i LÃ½ VIP</div>
      </div>
      <div class="stat-card">
        <div class="stat-number" id="totalProducts">0</div>
        <div class="stat-label">Tá»•ng Sáº£n Pháº©m</div>
      </div>
      <div class="stat-card">
        <div class="stat-number" id="todayProducts">0</div>
        <div class="stat-label">Sáº£n Pháº©m HÃ´m Nay</div>
      </div>
    </div>

    <!-- Announcement Bar Manager -->
    <div class="agents-table" style="margin-top: 20px;">
      <div style="padding: 20px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
        <h3 style="margin: 0;">ğŸ“¢ Quáº£n LÃ½ Thanh ThÃ´ng BÃ¡o</h3>
      </div>
      <div style="padding: 20px;">
        <label style="display: block; margin-bottom: 10px; font-weight: bold; color: #333;">
          Ná»™i dung thÃ´ng bÃ¡o cháº¡y:
        </label>
        <textarea 
          id="announcementText" 
          style="width: 100%; min-height: 100px; padding: 15px; border: 2px solid #ddd; border-radius: 8px; font-size: 16px; font-family: inherit; resize: vertical;"
          placeholder="Nháº­p ná»™i dung thÃ´ng bÃ¡o (cÃ³ thá»ƒ dÃ¹ng emoji: ğŸ‰ ğŸ›ï¸ ğŸ†)..."
        >ğŸ‰ Táº¡p HÃ³a Koh Kong lÃ  trang thÆ°Æ¡ng máº¡i Ä‘iá»‡n tá»­ Ä‘áº§u tiÃªn á»Ÿ Koh Kong thu hÃºt hÃ ng nghÃ¬n khÃ¡ch hÃ ng má»—i ngÃ y! ğŸ›ï¸ Giao hÃ ng nhanh - GiÃ¡ tá»‘t - Uy tÃ­n hÃ ng Ä‘áº§u! ğŸ† ÄÄƒng kÃ½ ngay Ä‘á»ƒ tráº£i nghiá»‡m!</textarea>
        
        <div style="margin-top: 15px; display: flex; gap: 10px; align-items: center;">
          <button onclick="saveAnnouncement()" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; padding: 12px 30px; border-radius: 8px; font-size: 16px; font-weight: bold; cursor: pointer; transition: transform 0.2s;">
            ğŸ’¾ LÆ°u ThÃ´ng BÃ¡o
          </button>
          <button onclick="previewAnnouncement()" style="background: #28a745; color: white; border: none; padding: 12px 30px; border-radius: 8px; font-size: 16px; font-weight: bold; cursor: pointer; transition: transform 0.2s;">
            ğŸ‘ï¸ Xem TrÆ°á»›c
          </button>
          <span id="saveStatus" style="color: #28a745; font-weight: bold;"></span>
        </div>
        
        <div style="margin-top: 20px; padding: 15px; background: #f8f9fa; border-radius: 8px; border-left: 4px solid #667eea;">
          <strong>ğŸ’¡ LÆ°u Ã½:</strong>
          <ul style="margin: 10px 0 0 20px; color: #666;">
            <li>Text sáº½ tá»± Ä‘á»™ng scroll tá»« pháº£i sang trÃ¡i</li>
            <li>Tá»‘c Ä‘á»™: 25 giÃ¢y cho 1 vÃ²ng</li>
            <li>Há»— trá»£ emoji vÃ  kÃ½ tá»± Ä‘áº·c biá»‡t</li>
            <li>Thay Ä‘á»•i sáº½ hiá»ƒn thá»‹ ngay láº­p tá»©c</li>
          </ul>
        </div>
      </div>
    </div>

    <!-- Agents Table -->
    <div class="agents-table">
      <table>
        <thead>
          <tr>
            <th>TÃªn Äáº¡i LÃ½</th>
            <th>Username</th>
            <th>Telegram</th>
            <th>IP Address</th>
            <th>Loáº¡i TÃ i Khoáº£n</th>
            <th>Háº¡n Má»©c HÃ´m Nay</th>
            <th>Sáº£n Pháº©m</th>
            <th>NgÃ y ÄÄƒng KÃ½</th>
            <th>Láº§n ÄÄƒng Nháº­p Cuá»‘i</th>
            <th>HÃ nh Äá»™ng</th>
          </tr>
        </thead>
        <tbody id="agentsTableBody">
          <tr>
            <td colspan="10" style="text-align: center; padding: 40px;">
              Äang táº£i dá»¯ liá»‡u...
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- Products Management Table -->
    <h2 style="margin-top: 40px; color: #667eea; text-align: center;">ğŸ“¦ Quáº£n LÃ½ Sáº£n Pháº©m Cá»§a Äáº¡i LÃ½</h2>
    <div class="agents-table" style="margin-top: 20px;">
      <table>
        <thead>
          <tr>
            <th>HÃ¬nh áº¢nh</th>
            <th>Sáº£n Pháº©m</th>
            <th>GiÃ¡ (USDT)</th>
            <th>Danh Má»¥c</th>
            <th>Äáº¡i LÃ½</th>
            <th>NgÃ y Táº¡o</th>
            <th>HÃ nh Äá»™ng</th>
          </tr>
        </thead>
        <tbody id="productsTableBody">
          <tr>
            <td colspan="7" style="text-align: center; padding: 40px;">
              Äang táº£i sáº£n pháº©m...
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- Blocked IPs Management -->
    <h2 style="margin-top: 40px; color: #667eea; text-align: center;">ğŸš« Quáº£n LÃ½ IP Bá»‹ Cháº·n</h2>
    <div class="agents-table" style="margin-top: 20px;">
      <table>
        <thead>
          <tr>
            <th>IP Address</th>
            <th>Username</th>
            <th>NgÃ y Cháº·n</th>
            <th>LÃ½ Do</th>
            <th>HÃ nh Äá»™ng</th>
          </tr>
        </thead>
        <tbody id="blockedIPsTableBody">
          <tr>
            <td colspan="5" style="text-align: center; padding: 40px;">
              Äang táº£i...
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <div style="margin-top: 20px; text-align: center;">
      <button class="btn-logout" onclick="logoutAdmin()">ÄÄƒng Xuáº¥t Admin</button>
    </div>
  </div>

  <script src="admin.js"></script>
  <script src="sample-products.js"></script>
  <script>
    // Announcement Management Functions
    function saveAnnouncement() {
      const text = document.getElementById('announcementText').value.trim();
      if (!text) {
        alert('âš ï¸ Vui lÃ²ng nháº­p ná»™i dung thÃ´ng bÃ¡o!');
        return;
      }
      
      // Save to localStorage
      localStorage.setItem('announcementText', text);
      
      // Show success message
      const status = document.getElementById('saveStatus');
      status.textContent = 'âœ… ÄÃ£ lÆ°u thÃ nh cÃ´ng!';
      status.style.color = '#28a745';
      
      setTimeout(() => {
        status.textContent = '';
      }, 3000);
      
      console.log('ğŸ“¢ Announcement saved:', text);
    }
    
    function previewAnnouncement() {
      const text = document.getElementById('announcementText').value.trim();
      if (!text) {
        alert('âš ï¸ Vui lÃ²ng nháº­p ná»™i dung thÃ´ng bÃ¡o!');
        return;
      }
      
      // Save first
      localStorage.setItem('announcementText', text);
      
      // Open homepage to preview
      window.open('index.html', '_blank');
    }
    
    // Load saved announcement on page load
    window.addEventListener('DOMContentLoaded', () => {
      const savedText = localStorage.getItem('announcementText');
      if (savedText) {
        document.getElementById('announcementText').value = savedText;
      }
    });

    // Add button to load sample products
    window.addEventListener('DOMContentLoaded', () => {
      const header = document.querySelector('.admin-header');
      const loadSampleBtn = document.createElement('button');
      loadSampleBtn.textContent = 'ğŸ“¦ ThÃªm 15 Sáº£n Pháº©m Máº«u';
      loadSampleBtn.style.cssText = 'background: #4CAF50; color: white; border: none; padding: 12px 24px; border-radius: 5px; cursor: pointer; margin-top: 10px; font-weight: bold; font-size: 1rem;';
      loadSampleBtn.onclick = () => {
        if (confirm('Báº¡n cÃ³ cháº¯c muá»‘n thÃªm 15 sáº£n pháº©m máº«u vÃ o website?')) {
          loadSampleProducts();
        }
      };
      header.appendChild(loadSampleBtn);
    });
  </script>
</body>
</html>
